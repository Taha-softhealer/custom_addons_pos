<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="sh_pos_mrp_custom.BomComponents">
        <tbody class="sh_bom_component_table">
            <t t-foreach="state_lines.components" t-as="com" t-key="com.id">
                <t t-set="table_len" t-value="props.table_len"></t>
                <tr class="sh-measurement-line-details sh-bom-line" t-att-class="'sh_bom_line'+table_len" t-att-line_len="table_len" t-att-sh_line_id="line_id || false">
                    <t t-if="com.display_name">
                        <td class="name" t-if="com ">
                            <select class="form-control sh_default_componenet_selection" disabled="true">
                                <option t-att-value="com.id">
                                    <t t-esc="com.display_name"/>
                                </option>
                            </select>
                        </td>

                        <td class="name" t-att-colspan="changes.sh_product_id and changes.sh_product_id[0] ? '1': '2'">
                            <t t-if="props.isfabric">
                                <input t-att-class="'form-control sh_bom_line_selection sh_is_fabric sh_bom_line_selection'+table_len" t-att-list="'datalistOptions'+table_len" t-model="changes.sh_product_id[1]" t-on-change="onChangeProduct" placeholder="Select a Product..." />
                                <datalist t-att-id="'datalistOptions'+table_len">
                                    <t t-foreach="fabric_products" t-as="product" t-key="product.id">
                                        <t t-if="product.id != changes.sh_product_id[0] ">
                                            <t t-set="sh_product_name" t-value="product.display_name.replaceAll(' ','_')"></t>
                                            <option t-att-value="sh_product_name" t-att-data-product_id="product.id"></option>
                                        </t>
                                    </t>
                                </datalist>
                            </t>
                            <t t-else="">
                                <input t-att-class="'form-control sh_bom_line_selection sh_bom_line_selection'+table_len" t-att-list="'datalistOptions'+table_len" t-model="changes.sh_product_name[com.id]" t-on-change="(ev) => this.onchangeProduct(ev, com.id)" placeholder="Select a Product..." />
                                <datalist t-att-id="'datalistOptions'+table_len">
                                    <t t-foreach="products" t-as="product" t-key="product.id">

                                        <t t-if="product.id == com.raw.product_id.id">
                                            <option t-att-value="product.display_name.replaceAll(' ','_')" t-att-data-product_id="product.id">
                                            </option>
                                        </t>
                                        <t t-if="product.id != com.raw.product_id.id ">
                                            <t t-set="sh_product_name" t-value="product.display_name.replaceAll(' ','_')"></t>
                                            <option t-att-selected="com.raw.product_id" t-att-value="sh_product_name" t-att-data-product_id="product.id"></option>
                                        </t>
                                    </t>
                                </datalist>
                            </t>
                        </td>
                    </t>

                    <t t-else="">
                        <td class="name" colspan="2">

                            <input t-att-class="'form-control sh_bom_line_selection sh_bom_line_selection'+table_len" t-att-list="'datalistOptions'+table_len" t-on-change="(ev) => this.add_onchangeProduct(ev, com.id)" placeholder="Select a Product..." t-model="state_lines.sh_product_name[com.id]"/>
                            <datalist t-att-id="'datalistOptions'+table_len">
                                <t t-foreach="products" t-as="product" t-key="product.id">
                                    <option t-att-value="product.display_name.replaceAll(' ','_')" t-att-data-product_id="product.id">
                                    </option>
                                </t>
                            </datalist>
                        </td>
                    </t>

                    <t t-if="com.product_qty">
                        <td class="size">
                            <input type="number" t-att-disabled="props.isfabric" t-att-class="'form-control sh_bom_quantity sh_bom_quantity'+table_len" t-model="changes.quantity[com.id]" t-att-component_qty="com.product_qty" t-att-name="'Quantity'+table_len" />
                        </td>
                    </t>
                    <t t-else="">
                        <td class="size">
                            <input type="number" t-att-class="'form-control sh_bom_quantity sh_bom_quantity'+table_len" t-att-name="'Quantity'+table_len" t-model="state_lines.quantity[com.id]" t-on-change="changeQuantity"/>
                        </td>
                    </t>
                    <t t-if="com.product_id">
                        <td>
                            <select t-att-name="'sh_bom_unit_'+table_len" t-att-disabled="props.isfabric" t-att-class="'form-control sh_bom_unit_selection sh_bom_unit_selection_'+table_len" class="operator" t-model="changes.sh_product_uom[com.id]">
                                <t t-foreach="this.get_unites(com.product_id)" t-as="unit" t-key="unit.id">
                                    <option t-att-value="unit.id" t-att-product_name="unit.display_name" t-att-selected="unit.id == com.product_id.uom_id.id">
                                        <t t-esc="unit.name"/>
                                    </option>
                                </t>
                            </select>
                        </td>
                    </t>
                    <t t-else="">
                        <td>
                            <select t-att-name="'sh_bom_unit_'+table_len" t-att-class="'form-control sh_bom_unit_selection sh_bom_unit_selection_'+table_len" class="operator" t-model="state_lines.sh_product_uom[com.id]" t-on-change="onchangeUOM">
                                <t t-foreach="state_lines.cat_units" t-as="unit" t-key="unit.id">
                                    <option t-att-value="unit.id" t-att-product_name="unit.display_name">
                                        <t t-esc="unit.name" />
                                    </option>
                                </t>
                            </select>
                        </td>
                    </t>
                    <td>
                        <button class='btn btn-secondary remove_line' t-if="!props.isfabric" id='remove_table_len' t-on-click="(ev) => this.remove_measurement_line(ev,com.id)">
                            <span class='fa fa-trash-o' ></span>
                        </button>
                    </td>
                </tr>





                <!-- Hello This is Break the LInes -->


            </t>

            <t t-if="state_lines.lines">
                <!-- <BomAddLineComponent products="products"/> -->
            </t>
        </tbody>
        <tfoot class="border-0">
            <tr>
                <td colspan='5' style="text-align: left; border-bottom:0;">
                    <button class="button confirm btn btn-sm btn-primary" t-on-click="add_new_line">add line</button>
                </td>
            </tr>
        </tfoot>
    </t>

</templates>